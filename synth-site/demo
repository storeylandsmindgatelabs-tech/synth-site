<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Storeylands MindGate Synth</title>
<style>
  body { margin: 0; overflow: hidden; font-family: sans-serif; background: #111; }
  #overlay {
    position: absolute;
    top: 20px;
    left: 20px;
    color: #fff;
    z-index: 10;
    font-size: 24px;
    font-weight: bold;
    transition: all 0.5s;
  }
  #menu {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 10;
    color: #fff;
    font-size: 18px;
    cursor: pointer;
    display: flex;
    gap: 15px;
  }
  #menu div:hover { text-decoration: underline; }
</style>
</head>
<body>
<div id="overlay">Storeylands MindGate</div>
<div id="menu">
  <div onclick="gotoSection(0)">Worlds</div>
  <div onclick="gotoSection(1)">Experiences</div>
  <div onclick="gotoSection(2)">Concepts</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.2/gsap.min.js"></script>
<script>
// === Scene Setup ===
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.z = 10;

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.05;
controls.enablePan = false;

const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
scene.add(ambientLight);

const directionalLight = new THREE.DirectionalLight(0xffffff, 0.6);
directionalLight.position.set(10, 10, 10);
scene.add(directionalLight);

// === Sections and Images ===
const sections = [
  { title: 'Worlds', images: [
    'https://via.placeholder.com/512x512/ff4444/fff?text=W1',
    'https://via.placeholder.com/512x512/ff8844/fff?text=W2',
    'https://via.placeholder.com/512x512/ffbb44/fff?text=W3',
    'https://via.placeholder.com/512x512/ffaa44/fff?text=W4'
  ]},
  { title: 'Experiences', images: [
    'https://via.placeholder.com/512x512/44ff44/fff?text=E1',
    'https://via.placeholder.com/512x512/44ff88/fff?text=E2',
    'https://via.placeholder.com/512x512/44ffbb/fff?text=E3',
    'https://via.placeholder.com/512x512/44ffaa/fff?text=E4'
  ]},
  { title: 'Concepts', images: [
    'https://via.placeholder.com/512x512/4444ff/fff?text=C1',
    'https://via.placeholder.com/512x512/8844ff/fff?text=C2',
    'https://via.placeholder.com/512x512/bb44ff/fff?text=C3',
    'https://via.placeholder.com/512x512/dd44ff/fff?text=C4'
  ]}
];

const panels = [];
const loader = new THREE.TextureLoader();
const sectionSpacing = 25;

// Create panels for each section
sections.forEach((sec, sIndex) => {
  sec.images.forEach((url, i) => {
    loader.load(url, texture => {
      const geometry = new THREE.PlaneGeometry(4, 4);
      const material = new THREE.MeshStandardMaterial({ map: texture, side: THREE.DoubleSide });
      const plane = new THREE.Mesh(geometry, material);

      plane.position.x = (Math.random() - 0.5) * 15;
      plane.position.y = (Math.random() - 0.5) * 10;
      plane.position.z = sIndex * -sectionSpacing + (Math.random() - 0.5) * 5;
      plane.rotation.y = Math.random() * Math.PI;

      scene.add(plane);
      panels.push({ mesh: plane, section: sIndex });
    });
  });
});

// === Camera & Navigation ===
let currentSection = 0;
const overlay = document.getElementById('overlay');

function gotoSection(index) {
  currentSection = THREE.MathUtils.clamp(index, 0, sections.length - 1);
  overlay.innerText = sections[currentSection].title;

  gsap.to(camera.position, {
    z: -currentSection * sectionSpacing + 10,
    duration: 2,
    ease: "power2.inOut"
  });
}

// Scroll navigation
window.addEventListener('wheel', (e) => {
  if (e.deltaY > 0) gotoSection(currentSection + 1);
  else if (e.deltaY < 0) gotoSection(currentSection - 1);
});

// Keyboard navigation
window.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowDown') gotoSection(currentSection + 1);
  if (e.key === 'ArrowUp') gotoSection(currentSection - 1);
});

// === Animate Panels ===
function animate() {
  requestAnimationFrame(animate);

  const time = Date.now() * 0.001;
  panels.forEach(p => {
    p.mesh.rotation.y += 0.002 + Math.random() * 0.001;
    p.mesh.position.y += Math.sin(time + p.mesh.position.x) * 0.002;
  });

  controls.update();
  renderer.render(scene, camera);
}

animate();

// Resize handling
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

// === Optional: Auto demo fly-through ===
let demoMode = true;
let demoTimer = 0;
function demoFly() {
  if (!demoMode) return;
  demoTimer += 0.01;
  const targetSection = Math.floor(demoTimer) % sections.length;
  gotoSection(targetSection);
  requestAnimationFrame(demoFly);
}
demoFly();
</script>
</body>
</html>